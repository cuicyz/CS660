drop table if exists Suppliers;
drop table if exists Parts;
drop table if exists Catalog;

create table Suppliers (
    sid integer primary key,
    sname char(20),
    address char(20));
create table Parts (
    pid integer primary key,
    pname char(20),
    color char(20));
create table Catalog (
    sid integer,
    pid integer,
    cost real);
    
insert into Suppliers values(10,'joe','freeman');
insert into Suppliers values(20,'cz','freeman');
insert into Suppliers values(30,'e','freeman');
insert into Parts values(100,'mmq','red');
insert into Parts values(200,'cz','blue');
insert into Parts values(300,'e','red');
insert into Catalog values(10,100,5500);
insert into Catalog values(10,200,6500);
insert into Catalog values(10,300,7500);

select distinct p.pname
from Parts p,Catalog C
where p.pid=c.pid;

select s.sname
from Suppliers s
where not exists((select p.pname
                 from Parts p
                 where p.color='red'
                 )
                except
                (select p.pname
                 from Catalog c,Parts p
                 where c.sid=s.sid and c.pid=p.pid and p.color='red'
                 ))
union
select s.sname
from Suppliers s
where not exists((select p.pname
                 from Parts p
                 where p.color='green'
                 )
                except
                (select p.pname
                 from Catalog c,Parts p
                 where c.sid=s.sid and c.pid=p.pid and p.color='green'
                 ))
                 
